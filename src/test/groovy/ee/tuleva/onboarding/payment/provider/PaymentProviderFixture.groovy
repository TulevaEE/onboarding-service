package ee.tuleva.onboarding.payment.provider

import ee.tuleva.onboarding.payment.PaymentData
import ee.tuleva.onboarding.payment.provider.montonio.MontonioNotificationBody
import ee.tuleva.onboarding.payment.provider.montonio.MontonioPaymentChannel
import ee.tuleva.onboarding.payment.provider.montonio.MontonioPaymentChannelConfiguration

import static ee.tuleva.onboarding.payment.PaymentData.PaymentChannel.LHV
import static ee.tuleva.onboarding.payment.PaymentData.PaymentChannel.TULUNDUSUHISTU
import static ee.tuleva.onboarding.payment.provider.PaymentProviderFixture.getaSerializedSinglePaymentFinishedToken


class PaymentProviderFixture {
  static String anAccessKey = "exampleAccessKey"
  static String aSecretKey = "exampleSecretKeyexampleSecretKeyexampleSecretKey"
  static String anAccessKeyTulundusuhistu = "exampleAccessKeyTulundusuhistu"
  static String aSecretKeyTulundusuhistu = "exampleSecretKeyexampleSecretKeyexampleSecretKeyTulundusuhistu"

  static MontonioPaymentChannelConfiguration aPaymentProviderConfiguration() {
    MontonioPaymentChannel samplePaymentProviderChannelConfiguration = new MontonioPaymentChannel()
    samplePaymentProviderChannelConfiguration.accessKey = anAccessKey
    samplePaymentProviderChannelConfiguration.secretKey = aSecretKey
    samplePaymentProviderChannelConfiguration.bic = "exampleAspsp"

    MontonioPaymentChannel samplePaymentProviderChannelConfigurationTulundusuhistu = new MontonioPaymentChannel()
    samplePaymentProviderChannelConfigurationTulundusuhistu.accessKey = anAccessKeyTulundusuhistu
    samplePaymentProviderChannelConfigurationTulundusuhistu.secretKey = aSecretKeyTulundusuhistu
    samplePaymentProviderChannelConfigurationTulundusuhistu.bic = "exampleAspsp"

    def configuration = new MontonioPaymentChannelConfiguration([
        (LHV)           : samplePaymentProviderChannelConfiguration,
        (TULUNDUSUHISTU): samplePaymentProviderChannelConfigurationTulundusuhistu,
    ])
    configuration.mapByAccessKey()
    return configuration
  }

  // Use jwt.io to edit payload, sign with exampleSecret from mocked PAYMENT_SECRET_LHV
  static PaymentReference anInternalReference =
      new PaymentReference("38812121215", "38812121215", UUID.fromString("3ab94f11-fb71-4401-8043-5e911227037e"), PaymentData.PaymentType.MEMBER_FEE, Locale.ENGLISH, "description")

  // notification and callback tokens are the same, can be used for testing both cases
  static String anInvalidSinglePaymentFinishedToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlIiwiYWNjZXNzS2V5IjoiZXhhbXBsZUFjY2Vzc0tleSIsImdyYW5kVG90YWwiOjEwLCJtZXJjaGFudFJlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsIm1lcmNoYW50UmVmZXJlbmNlRGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRTdGF0dXMiOiJQQUlEIiwicGF5bWVudE1ldGhvZCI6InBheW1lbnRJbml0aWF0aW9uIiwicGF5bWVudFByb3ZpZGVyTmFtZSI6IkxIViBFc3RvbmlhIiwic2VuZGVySWJhbiI6bnVsbCwic2VuZGVyTmFtZSI6bnVsbCwiY3VycmVuY3kiOiJFVVIiLCJtZXJjaGFudF9yZWZlcmVuY2UiOiJ7XCJwZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJyZWNpcGllbnRQZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJ1dWlkXCI6XCIzYWI5NGYxMS1mYjcxLTQ0MDEtODA0My01ZTkxMTIyNzAzN2VcIixcInBheW1lbnRUeXBlXCI6XCJTSU5HTEVcIixcImxvY2FsZVwiOlwiZXRcIn0iLCJtZXJjaGFudF9yZWZlcmVuY2VfZGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRfc3RhdHVzIjoiUEFJRCIsImlhdCI6MTcxOTkwMzYxNiwiZXhwIjoxNzIwNTA4NDE2fQ.nH7G_SY7LimfW2HOgEViINFW2Qjk1XXZKP7xmR_Oj12"
  static String aSerializedSinglePaymentFinishedToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlIiwiYWNjZXNzS2V5IjoiZXhhbXBsZUFjY2Vzc0tleSIsImdyYW5kVG90YWwiOjEwLCJtZXJjaGFudFJlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsIm1lcmNoYW50UmVmZXJlbmNlRGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRTdGF0dXMiOiJQQUlEIiwicGF5bWVudE1ldGhvZCI6InBheW1lbnRJbml0aWF0aW9uIiwicGF5bWVudFByb3ZpZGVyTmFtZSI6IkxIViBFc3RvbmlhIiwic2VuZGVySWJhbiI6bnVsbCwic2VuZGVyTmFtZSI6bnVsbCwiY3VycmVuY3kiOiJFVVIiLCJtZXJjaGFudF9yZWZlcmVuY2UiOiJ7XCJwZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJyZWNpcGllbnRQZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJ1dWlkXCI6XCIzYWI5NGYxMS1mYjcxLTQ0MDEtODA0My01ZTkxMTIyNzAzN2VcIixcInBheW1lbnRUeXBlXCI6XCJTSU5HTEVcIixcImxvY2FsZVwiOlwiZXRcIn0iLCJtZXJjaGFudF9yZWZlcmVuY2VfZGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRfc3RhdHVzIjoiUEFJRCIsImlhdCI6MTcxOTkwMzYxNiwiZXhwIjoxNzIwNTA4NDE2fQ.nH7G_SY7LimfW2HOgEViINFW2Qjk1XXZKP7xmR_Oj6c"
  static String aSerializedMemberPaymentFinishedToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJncmFuZFRvdGFsIjoiMTAuMDAiLCJhY2Nlc3NLZXkiOiJleGFtcGxlQWNjZXNzS2V5IiwibWVyY2hhbnRSZWZlcmVuY2UiOiJ7XCJwZXJzb25hbENvZGVcIjogXCIzODgxMjEyMTIxNVwiLCBcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOiBcIjM4ODEyMTIxMjE1XCIsIFwidXVpZFwiOiBcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLCBcInBheW1lbnRUeXBlXCI6IFwiTUVNQkVSX0ZFRVwiLFwibG9jYWxlXCI6XCJlblwifSIsInBheW1lbnRTdGF0dXMiOiJQQUlEIiwicGF5bWVudFByb3ZpZGVybmFtZSI6IlNFQiBFZXN0aSIsInV1aWQiOiIzYWI5NGYxMS1mYjcxLTQ0MDEtODA0My01ZTkxMTIyNzAzN2UiLCJpYXQiOjE2NjQxOTAzMjQsImV4cCI6MTY2NDIwNDcyNH0.4jr3mLEDOICdxGAe54EN5PaATl40eeSxWICcdNeiI-w"
  static String aSerializedPaymentPendingToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlIiwiYWNjZXNzS2V5IjoiZXhhbXBsZUFjY2Vzc0tleSIsImdyYW5kVG90YWwiOjEwLCJtZXJjaGFudFJlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsIm1lcmNoYW50UmVmZXJlbmNlRGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRTdGF0dXMiOiJQRU5ESU5HIiwicGF5bWVudE1ldGhvZCI6InBheW1lbnRJbml0aWF0aW9uIiwicGF5bWVudFByb3ZpZGVyTmFtZSI6IkxIViBFc3RvbmlhIiwic2VuZGVySWJhbiI6bnVsbCwic2VuZGVyTmFtZSI6bnVsbCwiY3VycmVuY3kiOiJFVVIiLCJtZXJjaGFudF9yZWZlcmVuY2UiOiJ7XCJwZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJyZWNpcGllbnRQZXJzb25hbENvZGVcIjpcIjM4ODEyMTIxMjE1XCIsXCJ1dWlkXCI6XCIzYWI5NGYxMS1mYjcxLTQ0MDEtODA0My01ZTkxMTIyNzAzN2VcIixcInBheW1lbnRUeXBlXCI6XCJTSU5HTEVcIixcImxvY2FsZVwiOlwiZXRcIn0iLCJtZXJjaGFudF9yZWZlcmVuY2VfZGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRfc3RhdHVzIjoiUEFJRCIsImlhdCI6MTcxOTkwMzYxNiwiZXhwIjoxNzIwNTA4NDE2fQ.rkOSrI_TXSUH_LnwDaJwf0pQ_0zs19jG43IDygytz80"
  static String aSerializedPaymentFailedToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlIiwiYWNjZXNzS2V5IjoiZXhhbXBsZUFjY2Vzc0tleSIsImdyYW5kVG90YWwiOjEwLCJtZXJjaGFudFJlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsIm1lcmNoYW50UmVmZXJlbmNlRGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsInBheW1lbnRTdGF0dXMiOiJWT0lERUQiLCJwYXltZW50TWV0aG9kIjoicGF5bWVudEluaXRpYXRpb24iLCJwYXltZW50UHJvdmlkZXJOYW1lIjoiTEhWIEVzdG9uaWEiLCJzZW5kZXJJYmFuIjpudWxsLCJzZW5kZXJOYW1lIjpudWxsLCJjdXJyZW5jeSI6IkVVUiIsIm1lcmNoYW50X3JlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNJTkdMRVwiLFwibG9jYWxlXCI6XCJldFwifSIsIm1lcmNoYW50X3JlZmVyZW5jZV9kaXNwbGF5Ijoie1wicGVyc29uYWxDb2RlXCI6XCIzODgxMjEyMTIxNVwiLFwicmVjaXBpZW50UGVyc29uYWxDb2RlXCI6XCIzODgxMjEyMTIxNVwiLFwidXVpZFwiOlwiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlXCIsXCJwYXltZW50VHlwZVwiOlwiU0lOR0xFXCIsXCJsb2NhbGVcIjpcImV0XCJ9IiwicGF5bWVudF9zdGF0dXMiOiJQQUlEIiwiaWF0IjoxNzE5OTAzNjE2LCJleHAiOjE3MjA1MDg0MTZ9.PCCRgkOsyAmQBgsJBddnNW0hgy99OquwNrY3ipDfgMQ"
  static String aSerializedSavingsPaymentToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1dWlkIjoiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlIiwiYWNjZXNzS2V5IjoiZXhhbXBsZUFjY2Vzc0tleSIsImdyYW5kVG90YWwiOjEwLCJtZXJjaGFudFJlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNBVklOR1NcIixcImxvY2FsZVwiOlwiZW5cIixcImRlc2NyaXB0aW9uXCI6XCJkZXNjcmlwdGlvblwifSIsIm1lcmNoYW50UmVmZXJlbmNlRGlzcGxheSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNBVklOR1NcIixcImxvY2FsZVwiOlwiZW5cIixcImRlc2NyaXB0aW9uXCI6XCJkZXNjcmlwdGlvblwifSIsInBheW1lbnRTdGF0dXMiOiJQQUlEIiwicGF5bWVudE1ldGhvZCI6InBheW1lbnRJbml0aWF0aW9uIiwicGF5bWVudFByb3ZpZGVyTmFtZSI6IkxIViBFc3RvbmlhIiwic2VuZGVySWJhbiI6IkVFMjExNzIyODM5MDk1MDMwNDU0Iiwic2VuZGVyTmFtZSI6IkZpcnN0IExhc3QiLCJjdXJyZW5jeSI6IkVVUiIsIm1lcmNoYW50X3JlZmVyZW5jZSI6IntcInBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInJlY2lwaWVudFBlcnNvbmFsQ29kZVwiOlwiMzg4MTIxMjEyMTVcIixcInV1aWRcIjpcIjNhYjk0ZjExLWZiNzEtNDQwMS04MDQzLTVlOTExMjI3MDM3ZVwiLFwicGF5bWVudFR5cGVcIjpcIlNBVklOR1NcIixcImxvY2FsZVwiOlwiZW5cIixcImRlc2NyaXB0aW9uXCI6XCJkZXNjcmlwdGlvblwifSIsIm1lcmNoYW50X3JlZmVyZW5jZV9kaXNwbGF5Ijoie1wicGVyc29uYWxDb2RlXCI6XCIzODgxMjEyMTIxNVwiLFwicmVjaXBpZW50UGVyc29uYWxDb2RlXCI6XCIzODgxMjEyMTIxNVwiLFwidXVpZFwiOlwiM2FiOTRmMTEtZmI3MS00NDAxLTgwNDMtNWU5MTEyMjcwMzdlXCIsXCJwYXltZW50VHlwZVwiOlwiU0FWSU5HU1wiLFwibG9jYWxlXCI6XCJlblwiLFwiZGVzY3JpcHRpb25cIjpcImRlc2NyaXB0aW9uXCJ9IiwicGF5bWVudF9zdGF0dXMiOiJQQUlEIiwiaWF0IjoxNzE5OTAzNjE2LCJleHAiOjE3MjA1MDg0MTZ9.k2wlVCFQ1vclLswkyXAVgaNT_qniTA3s8TtiCQRFBWo"

  static MontonioNotificationBody montonioNotification = new MontonioNotificationBody(aSerializedSinglePaymentFinishedToken)
}
